template: victron-ev-charging-station
products:
  - brand: Victron
    description:
      en: Victron EV charging station. Charger has to be in manual mode and modbus hs to be configured so that ID=100
      de: Victron EV charging station. Der charger muss im mode "Manual" sein, modbus ID muss 100 sein.
params:
  - name: modbus
    choice: ["tcpip"]
render: |
  type: custom
  status:
    source: go
    script: |       
      switch RawValue {
        case 0: WallboxStatus = "A"
        case 1: WallboxStatus = "B"
        case 2: WallboxStatus = "C"
        case 8,9,10,11,12,13,14 WallboxStatus =  "E"
        default: WallboxStatus = "F"
      }
      WallboxStatus 
    in:
      - name: RawValue
        type: int64
        config:
          source: modbus
          {{- include "modbus" . | indent 8 }}
          register: 3824
          type: holding
          decode: uin16
  enabled:
    source: modbus
    {{- include "modbus" . | indent 2 }}
    register: # manual register configuration
      address: 3826
      type: holding
      decode: uint16
  enable:
    source: modbus
    {{- include "modbus" . | indent 2 }}
    register: # manual register configuration
      address: 3826 # ein / aus
      type: writeholding
      decode: uint16
  maxcurrent:
    source: modbus
    {{- include "modbus" . | indent 2 }}
    register: # manual register configuration
      address: 3825 # Strom max
      type: writeholding
      decode: uint16
