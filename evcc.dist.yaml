uri: 0.0.0.0:7070 # uri for ui
interval: 10s # control cycle interval

log: error
levels:
  core: debug
  lp-1: debug
  lp-2: debug

# mqtt message broker
mqtt:
  broker: localhost:1883
  topic: evcc # root topic for publishing, set empty to disable
  # user:
  # password:

# influx database (v1)
influx:
  url: http://localhost:8086
  database: evcc
  # user:
  # password:

# additional menu entries
menu:
# - title: "Verlauf"
#   subtitle: "Bezugs- und Einspeiseleistung"
#   img: "http://..."
#   link: "http://..."
#   iframe: "http://..."

# push messages
messaging:
  events:
    start: # charge start event
      title: Charge started
      msg: Started charging in "${mode}" mode
    stop: # charge stop event
      title: Charge finished
      msg: Finished charging ${chargedEnergy:%.1fk}kWh in ${chargeDuration}.
    connect: # vehicle connect event
      title: Car connected
      msg: "Car connected at ${pvPower:%.1fk}kW PV"
    disconnect: # vehicle connected event
      title: Car disconnected
      msg: Car disconnected after ${connectedDuration}
  services:
  - type: pushover
    app: # app id
    recipients:
    - # list of recipient ids
  - type: telegram
    token: # bot id
    chats:
    - # list of chat ids
  - type: email
    uri: smtp://<user>:<password>@<host>:<port>/?fromAddress=<from>&toAddresses=<to>

# meters
meters:
- name: grid
  type: default
  power: # power reading
    type: mqtt # use mqtt
    topic: mbmd/sdm1-1/Power # mqtt topic
    timeout: 10s # don't use older values
- name: pv
  type: default
  power:
    type: mqtt
    topic: mbmd/sdm1-2/Power
    timeout: 10s # don't use older values
- name: battery
  type: default
  power:
    type: mqtt
    topic: mbmd/sma1-1/Power
    timeout: 10s # don't use older values
- name: charge
  type: default
  power:
    type: script # use script
    cmd: /bin/sh -c "echo 0" # actual command
    timeout: 3s # kill script after 3 seconds
- name: sma
  type: sma # SMA Home Manager 2.0 or SMA Energy Meter 30
  serial: 1234567890 # Serial number of the device, if this is defined uri is not needed!
  uri: 192.168.1.4 # IP address of the device, if this is defined serial is not needed!
- name: sdm
  type: modbus
  model: sdm
  uri: rs485.fritz.box:23
  rtu: true # rs485 device connected using ethernet adapter
  id: 2
  power: Power # default values, optionally override
  energy: Sum # default values, optionally override
- name: e3dc-battery
  type: default
  power:
    type: modbus
    uri: e3dc.fritz.box:502
    id: 1
    register: # manual register configuration
      address: 40070
      type: holding
      decode: int32
    scale: -1 # reverse direction

chargers:
- name: wallbe
  type: wallbe # Wallbe charger
  uri: 192.168.0.8:502 # ModBus address
# legacy: true # enable for older Wallbes with Phoenix EV-CC-AC1-M3-CBC-RCM controller
- name: phoenix
  type: phoenix-emcp # Charger with Phoenix Contact controller
  uri: 192.168.0.8:502 # ModBus address
  id: 1
- name: simpleevse-tcp
  type: simpleevse # Charger with Phoenix Contact controller
  uri: 192.168.0.8:502 # TCP ModBus address
- name: simpleevse-rtu
  type: simpleevse # Charger with Phoenix Contact controller
  device: /dev/usb1 # RS485 ModBus device
- name: evsewifi
  type: evsewifi # Charger with Phoenix Contact controller
  uri: http://192.168.1.4 # SimpleEVSE-Wifi address
- name: nrg-1
  type: nrgkick-connect # NRGKick Connect charger
  uri: http://192.168.1.4 # uri
  mac: 00:99:22 # MAC address
  password: # password
# - name: nrg-2
#   type: nrgkick-bluetooth # NRGKick charger with Bluetooth
#   macaddress: 00:99:22 # MAC address
#   pin: # pin
- name: go-e
  type: go-e # go-eCharger
  uri: http://192.168.1.4 # either go-e local address
  # token: 4711c # or go-e cloud API token
  cache: 10s # go-e cloud API cache duration
- name: keba
  type: keba # KEBA charger
  uri: 192.168.1.4:7090 # KEBA address
  rfid:
    tag: 765765348 # RFID tag, see `evcc charger` to show tag
- name: mcc
  type: mcc # Mobile Charger Connect (Audi, Bentley, Porsche)
  uri: https://192.168.1.4 # Mobile Charger Connect address
  password: # home user password
- name: configurable
  type: default # Configurable charger
  status: # charger status A..F
    type: mqtt
    topic: some/topic1
  enabled: # charger enabled state (true/false or 0/1)
    type: mqtt
    topic: some/topic2
  enable: # set charger enabled state
    type: script
    cmd: /bin/sh -c "echo ${enable}"
  maxcurrent: # set charger max current
    type: script
    cmd: /bin/sh -c "echo ${maxcurrent}"

vehicles:
- name: default
  type: default
  title: Default
  capacity: 50 # kWh
  charge:
    type: script # use script
    cmd: /bin/sh -c "echo 50" # actual command
    timeout: 3s # kill script after 3 seconds
  cache: 5m
- name: audi
  type: audi
  title: Q55 TFSIe
  capacity: 10 # kWh
  user: # user
  password: # password
  vin: WAUZZZ...
  cache: 5m
- name: bmw
  type: bmw
  title: i3
  capacity: 65 # kWh
  user: # user
  password: # password
  vin: WBMW...
  cache: 5m
# - name: tesla
#   type: tesla
#   title: Model S
#   capacity: 90 # kWh
#   clientid: # client id
#   clientsecret: # client secret
#   email: # email
#   password: # password
#   vin: WTSLA...
#   cache: 5m
# - name: nissan
#   type: nissan
#   title: Leaf
#   capacity: 60 # kWh
#   user: # user
#   password: # password
#   region: NE # carwings region, leave empty for Europe
#   cache: 5m
# - name: renault
#   type: renault
#   title: Zoe
#   capacity: 60 # kWh
#   user: # user
#   password: # password
#   region: de_DE # gigya region
#   vin: WREN...
#   cache: 5m
# - name: porsche
#   type: porsche
#   title: Taycan
#   capacity: 83 # kWh
#   user: # user
#   password: # password
#   vin: WP...
#   cache: 5m

site:
  title: Home # display name for UI
  meters:
    grid: grid # grid meter
    pv: pv # pv meter
    battery: battery # battery meter

loadpoints:
- title: Garage # display name for UI
  charger: wallbe # charger
  meters:
    charge: charge # charge meter
  vehicle: audi
  mode: pv
  soc:
    alwaysUpdate: false # set true to update vehicle soc even when disconnected
    levels: # target soc levels for UI
    - 30
    - 50
    - 80
    - 100
  onDisconnect:
    mode: pv # switch back to pv mode
    targetSoC: 100 # charge fully
  phases: 3 # ev phases (default 3)
  sensitivity: 1 # current raise/lower step size (default 10A)
  enable: # pv mode enable behavior
    delay: 1m # threshold must be exceeded for this long
    threshold: 0 # minimum export power (W). If zero, export must exceeds minimum charge power to enable
  disable: # pv mode disable behavior
    delay: 5m # threshold must be exceeded for this long
    threshold: 200 # maximum import power (W)
  guardduration: 10m # switch charger contactor not more often than this (default 10m)
  mincurrent: 6 # minimum charge current (default 6A)
  maxcurrent: 16 # maximum charge current (default 16A)
